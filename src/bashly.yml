name: git-draft
help: Stash, don't stage!
version: 0.0.0

dependencies: [git]

commands:
- name: commit
  short: c
  help: Commit the active draft
  
  flags:
  - long: --message
    short: -m
    arg: msg
    help: "Use the given <MSG> as the commit message. This will discard the draft's message if it has one."

  examples:
  - git-draft commit

- name: status
  short: st
  help: Show working tree status, draft-aware version
  
  examples:
  - git-draft status

- name: create
  help: Create a new stashed draft
  
  flags:
  - long: --message
    short: -m
    arg: msg
    help: "Use the given <MSG> as the commit message. This will append to the draft's message if it already has one."
  - long: --from-index
    short: -i
    help: "Create a draft containing a copy of the index. (This is the only index-aware command.)"
  - long: --delete-from-worktree
    short: -d
    help: "After creating the draft, remove any changes it contains from the worktree"
  
  examples:
  - git-draft create

- name: switch
  help: Make a different draft into the active draft (stashing the currently active one if it exists)
  args:
  - name: draft-name
    required: true
    
  examples:
  - git-draft switch main-episno

- name: show
  help: Show the contents of a draft
  
  args:
  - name: draft-name

- name: list
  help: Print a list of drafts

- name: drop
  help: Delete a draft
  args:
  - name: draft-name
    required: true

- name: describe
  group: Plumbing
  help: Print a description of the draft
  args:
  - name: draft-name
    required: true

- name: get-commit-message
  help: Print the commit message for a draft
  args:
  - name: draft-name
    required: true

- name: get-trailers
  help: Get trailers for a draft (see git-interpret-trailers(1) for details)
  args:
  - name: draft-name
    required: true

- name: get-trailer
  help: Get a trailer for a draft by name
  args:
  - name: draft-name
    required: true
  - name: trailer-name
    required: true

- name: active-is-empty
  help: "Returns 'y' if the active commit is an empty commit, 'n' otherwise"

- name: apply
  help: "Applies a draft to the working directory (like git apply)"
  args:
  - name: draft-name
    required: true
  flags:
  # Flags that come from `git apply`: (TODO bring more in, these are just the ones we need for internal use)
  - long: --check
  - long: --3way
    short: '-3'
  - long: --reverse
    short: '-R'
  - long: --index

- name: activate-stashed
  help: "Makes a stashed draft into the active draft (the current active draft must be an empty draft)"
  args:
  - name: draft-name
